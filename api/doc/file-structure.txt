Open API Kundenbeziehung - Complete File Structure
===============================================================

Root Files
â”œâ”€â”€ openapi.yaml                    # Complete OpenAPI specification
â”œâ”€â”€ package.json                    # Node.js dependencies and scripts
â”œâ”€â”€ .env-config.sh                  # Environment configuration template
â”œâ”€â”€ README.md                       # Complete project documentation
â”œâ”€â”€ Dockerfile                      # Docker container configuration
â”œâ”€â”€ docker-compose.yml              # Multi-service Docker setup
â”œâ”€â”€ .gitignore                      # Git ignore patterns
â””â”€â”€ .eslintrc.js                    # ESLint configuration

ğŸ“ src/ - Application Source Code
â”œâ”€â”€ app.js                          # Main Express application server (FAPI 2.0 compliant)
â”œâ”€â”€ ğŸ“ core/                        # Universal Core Framework
â”‚   â”œâ”€â”€ index.js                    # Core framework main module
â”‚   â”œâ”€â”€ ğŸ“ consent/
â”‚   â”‚   â””â”€â”€ index.js                # Universal consent management system
â”‚   â”œâ”€â”€ ğŸ“ extensions/
â”‚   â”‚   â””â”€â”€ index.js                # Extension system architecture
â”‚   â”œâ”€â”€ ğŸ“ models/
â”‚   â”‚   â””â”€â”€ index.js                # Universal data models and schemas
â”‚   â”œâ”€â”€ ğŸ“ process/
â”‚   â”‚   â””â”€â”€ index.js                # 10-step Referenzprozess orchestration
â”‚   â”œâ”€â”€ ğŸ“ registry/
â”‚   â”‚   â””â”€â”€ index.js                # Multi-industry participant registry
â”‚   â”œâ”€â”€ ğŸ“ trust/
â”‚   â”‚   â””â”€â”€ index.js                # Trust network component
â”‚   â””â”€â”€ ğŸ“ validation/
â”‚       â””â”€â”€ index.js                # Universal validation framework
â”œâ”€â”€ ğŸ“ extensions/                  # Industry-Specific Extensions
â”‚   â””â”€â”€ ğŸ“ banking/
â”‚       â”œâ”€â”€ index.js                # Banking extension main module
â”‚       â”œâ”€â”€ compliance.js           # Banking compliance (FINMA, GwG)
â”‚       â”œâ”€â”€ models.js               # Banking-specific data models
â”‚       â”œâ”€â”€ processes.js            # Banking business processes
â”‚       â””â”€â”€ validation.js           # Banking validation rules
â”œâ”€â”€ ğŸ“ middleware/
â”‚   â”œâ”€â”€ auth.js                     # FAPI 2.0 JWT authentication & DPoP validation
â”‚   â”œâ”€â”€ mtls.js                     # Mutual TLS + private_key_jwt authentication
â”‚   â”œâ”€â”€ security.js                 # Enhanced security middleware & audit
â”‚   â”œâ”€â”€ validation.js               # Request/response validation (Joi)
â”‚   â””â”€â”€ error-handler.js            # Centralized error handling
â”œâ”€â”€ ğŸ“ routes/
â”‚   â”œâ”€â”€ consent.js                  # Consent management endpoints
â”‚   â”œâ”€â”€ customer.js                 # Customer data exchange
â”‚   â”œâ”€â”€ identification.js           # Identity verification services
â”‚   â”œâ”€â”€ checks.js                   # Background checks (KYC/AML/PEP)
â”‚   â”œâ”€â”€ signature.js                # Digital signature services
â”‚   â”œâ”€â”€ registry.js                 # Participant registry
â”‚   â”œâ”€â”€ health.js                   # Health check endpoints
â”‚   â”œâ”€â”€ oauth.js                    # OAuth 2.1/OIDC authorization server
â”‚   â”œâ”€â”€ clients.js                  # Dynamic client registration (RFC 7591)
â”‚   â”œâ”€â”€ discovery.js                # OIDC/FAPI discovery endpoints
â”‚   â”œâ”€â”€ jwks.js                     # JWT key management & JWK Set
â”‚   â”œâ”€â”€ par.js                      # Pushed Authorization Requests
â”‚   â””â”€â”€ security-dashboard.js       # Security metrics & audit dashboard
â”œâ”€â”€ ğŸ“ services/                    # Service Layer
â”‚   â”œâ”€â”€ index.js                    # Service manager
â”‚   â”œâ”€â”€ consentService.js           # Consent business logic
â”‚   â”œâ”€â”€ customerService.js          # Customer data management
â”‚   â”œâ”€â”€ identificationService.js    # Identity verification logic
â”‚   â”œâ”€â”€ checksService.js            # Background check services
â”‚   â”œâ”€â”€ signatureService.js         # Digital signature services
â”‚   â”œâ”€â”€ registryService.js          # Registry management
â”‚   â”œâ”€â”€ processService.js           # Process orchestration
â”‚   â”œâ”€â”€ validationService.js        # Validation services
â”‚   â””â”€â”€ securityAuditService.js     # Security audit & monitoring
â”œâ”€â”€ ğŸ“ utils/
â”‚   â””â”€â”€ logger.js                   # Winston-based logging utility
â””â”€â”€ ğŸ“ models/                      # Data models (legacy - moved to core)
    â”œâ”€â”€ Customer.js
    â”œâ”€â”€ Consent.js
    â””â”€â”€ Institution.js

ğŸ“ config/ - Configuration Files
â”œâ”€â”€ database.js                     # Database connection config
â”œâ”€â”€ security.js                     # Security settings
â””â”€â”€ environments/
    â”œâ”€â”€ development.js
    â”œâ”€â”€ production.js
    â””â”€â”€ test.js

ğŸ“ certificates/ - Certificate Management
â”œâ”€â”€ trusted/                        # Trusted institution certificates
â”œâ”€â”€ client/                         # Client certificates for mTLS
â””â”€â”€ ca/                             # Certificate Authority files

ğŸ“ docs/ - Documentation
â”œâ”€â”€ api-reference.md                # Detailed API reference
â”œâ”€â”€ security-guide.md               # Security implementation guide
â”œâ”€â”€ deployment-guide.md             # Production deployment guide
â”œâ”€â”€ developer-guide.md              # Developer setup and usage
â”œâ”€â”€ compliance.md                   # Regulatory compliance guide
â””â”€â”€ ğŸ“ postman/                     # Postman collections
    â”œâ”€â”€ Open-API-Kundenbeziehung.postman_collection.json
    â””â”€â”€ environments/

ğŸ“ tests/ - Comprehensive Testing Framework (>95% Coverage Target)
â”œâ”€â”€ jest.config.js                  # Jest configuration with 4-layer testing
â”œâ”€â”€ ğŸ“ setup/                       # Test environment setup
â”‚   â”œâ”€â”€ jest.setup.js               # Global test setup & custom matchers
â”‚   â”œâ”€â”€ unit.setup.js               # Unit test configuration & mocks
â”‚   â”œâ”€â”€ integration.setup.js        # Integration test utilities
â”‚   â”œâ”€â”€ system.setup.js             # System test utilities & performance
â”‚   â””â”€â”€ acceptance.setup.js         # Use case validation utilities
â”œâ”€â”€ ğŸ“ unit/                        # Layer 1: Unit Testing (Individual Functions)
â”‚   â”œâ”€â”€ ğŸ“ routes/                  # Route handler tests
â”‚   â”‚   â”œâ”€â”€ oauth.test.js           # OAuth 2.1/OIDC endpoint tests
â”‚   â”‚   â”œâ”€â”€ clients.test.js         # Dynamic client registration tests
â”‚   â”‚   â”œâ”€â”€ consent.test.js         # Consent management tests
â”‚   â”‚   â””â”€â”€ security.test.js        # Security middleware tests
â”‚   â”œâ”€â”€ ğŸ“ services/                # Service layer tests
â”‚   â”‚   â”œâ”€â”€ securityAuditService.test.js
â”‚   â”‚   â”œâ”€â”€ consentService.test.js
â”‚   â”‚   â””â”€â”€ customerService.test.js
â”‚   â”œâ”€â”€ ğŸ“ middleware/              # Middleware tests (100% coverage required)
â”‚   â”‚   â”œâ”€â”€ auth.test.js            # FAPI 2.0 authentication tests
â”‚   â”‚   â”œâ”€â”€ mtls.test.js            # mTLS & private_key_jwt tests
â”‚   â”‚   â””â”€â”€ security.test.js        # Security audit middleware tests
â”‚   â”œâ”€â”€ ğŸ“ core/                    # Core framework tests
â”‚   â”‚   â”œâ”€â”€ consent.test.js
â”‚   â”‚   â”œâ”€â”€ process.test.js
â”‚   â”‚   â””â”€â”€ registry.test.js
â”‚   â””â”€â”€ ğŸ“ extensions/              # Extension tests
â”‚       â””â”€â”€ banking.test.js
â”œâ”€â”€ ğŸ“ integration/                 # Layer 2: Integration Testing (API Contracts)
â”‚   â”œâ”€â”€ ğŸ“ api/                     # API contract tests
â”‚   â”‚   â”œâ”€â”€ oauth-flow.test.js      # Complete OAuth 2.1 flow integration
â”‚   â”‚   â”œâ”€â”€ fapi-compliance.test.js # FAPI 2.0 compliance validation
â”‚   â”‚   â””â”€â”€ client-registration.test.js
â”‚   â”œâ”€â”€ ğŸ“ database/                # Database integration
â”‚   â”œâ”€â”€ ğŸ“ services/                # Service-to-service communication
â”‚   â””â”€â”€ ğŸ“ security/                # Security integration tests
â”‚       â”œâ”€â”€ dpop-validation.test.js
â”‚       â””â”€â”€ audit-logging.test.js
â”œâ”€â”€ ğŸ“ system/                      # Layer 3: System Testing (End-to-End)
â”‚   â”œâ”€â”€ ğŸ“ workflows/               # Complete business workflows
â”‚   â”‚   â”œâ”€â”€ account-opening.test.js # UC1 system test
â”‚   â”‚   â”œâ”€â”€ reidentification.test.js # UC2 system test
â”‚   â”‚   â””â”€â”€ age-verification.test.js # UC3 system test
â”‚   â”œâ”€â”€ ğŸ“ performance/             # Performance & load testing
â”‚   â”‚   â”œâ”€â”€ load-testing.test.js    # Concurrent user simulation
â”‚   â”‚   â””â”€â”€ response-time.test.js   # Response time validation
â”‚   â””â”€â”€ ğŸ“ security/                # Security testing
â”‚       â”œâ”€â”€ penetration.test.js     # Basic security scanning
â”‚       â””â”€â”€ vulnerability.test.js   # Vulnerability assessment
â”œâ”€â”€ ğŸ“ acceptance/                  # Layer 4: Acceptance Testing (Use Cases)
â”‚   â”œâ”€â”€ ğŸ“ use-cases/               # Use case validation
â”‚   â”‚   â”œâ”€â”€ uc1-banking.test.js     # UC1: Banking Account Opening
â”‚   â”‚   â”œâ”€â”€ uc2-reidentification.test.js # UC2: Re-identification
â”‚   â”‚   â”œâ”€â”€ uc3-age-verification.test.js # UC3: Age Verification
â”‚   â”‚   â””â”€â”€ uc4-evv-lifecycle.test.js # UC4: EVV Lifecycle Management
â”‚   â”œâ”€â”€ ğŸ“ demos/                   # Demo scenario validation
â”‚   â”‚   â”œâ”€â”€ reference-process.test.js
â”‚   â”‚   â””â”€â”€ consent-flow.test.js
â”‚   â””â”€â”€ ğŸ“ compliance/              # Regulatory compliance tests
â”‚       â”œâ”€â”€ finma-compliance.test.js
â”‚       â””â”€â”€ gdpr-compliance.test.js
â”œâ”€â”€ ğŸ“ fixtures/                    # Test data & mocks
â”‚   â”œâ”€â”€ sample-customers.json
â”‚   â”œâ”€â”€ test-certificates.json
â”‚   â”œâ”€â”€ oauth-clients.json
â”‚   â””â”€â”€ test-tokens.json
â”œâ”€â”€ ğŸ“ utils/                       # Test utilities
â”‚   â”œâ”€â”€ oauth-helpers.js            # OAuth flow test helpers
â”‚   â”œâ”€â”€ certificate-mocks.js       # mTLS certificate mocks
â”‚   â””â”€â”€ performance-helpers.js     # Performance testing utilities
â””â”€â”€ ğŸ“ mocks/                       # External service mocks
    â”œâ”€â”€ external-apis.js
    â””â”€â”€ database-mocks.js

ğŸ“ scripts/ - Utility Scripts
â”œâ”€â”€ setup.sh                       # Initial setup script
â”œâ”€â”€ generate-certs.sh               # Certificate generation
â”œâ”€â”€ migrate-db.js                   # Database migrations
â””â”€â”€ seed-data.js                    # Sample data seeding

ğŸ“ nginx/ - Reverse Proxy Configuration
â”œâ”€â”€ nginx.conf                      # Main Nginx configuration
â”œâ”€â”€ ssl/                            # SSL certificates
â””â”€â”€ sites-available/
    â””â”€â”€ open-api-kundenbeziehung

ğŸ“ logs/ - Application Logs (created at runtime)
â”œâ”€â”€ app.log                         # General application logs
â”œâ”€â”€ error.log                       # Error logs
â”œâ”€â”€ security.log                    # Security events
â”œâ”€â”€ audit.log                       # Audit trail
â””â”€â”€ access.log                      # HTTP access logs

ğŸ“ monitoring/ - Monitoring & Observability
â”œâ”€â”€ prometheus.yml                  # Prometheus configuration
â”œâ”€â”€ grafana/
â”‚   â””â”€â”€ dashboards/
â”‚       â”œâ”€â”€ api-metrics.json
â”‚       â””â”€â”€ security-metrics.json
â””â”€â”€ alerting/
    â””â”€â”€ rules.yml

Additional Configuration Files
â”œâ”€â”€ .dockerignore                   # Docker ignore patterns
â”œâ”€â”€ .env.production                 # Production environment
â”œâ”€â”€ .env.test                       # Test environment
â”œâ”€â”€ ecosystem.config.js             # PM2 process manager config
â”œâ”€â”€ jest.config.js                  # Jest testing configuration
â”œâ”€â”€ healthcheck.js                  # Docker healthcheck script
â””â”€â”€ CHANGELOG.md                    # Version history

Development Files
â”œâ”€â”€ .vscode/                        # VS Code settings
â”‚   â”œâ”€â”€ settings.json
â”‚   â””â”€â”€ launch.json
â”œâ”€â”€ .github/                        # GitHub workflows
â”‚   â””â”€â”€ workflows/
â”‚       â”œâ”€â”€ ci.yml
â”‚       â””â”€â”€ security-scan.yml
â””â”€â”€ LICENSE                         # License

===============================================================

Quick Start Commands:
- npm install                       # Install dependencies
- cp .env.example .env              # Setup environment
- npm run dev                       # Start development server
- docker-compose up -d              # Run with Docker
- npm test                          # Run complete test suite (4-layer)
- npm run test:unit                 # Run unit tests only
- npm run test:integration          # Run integration tests
- npm run test:system               # Run system tests (E2E)
- npm run test:acceptance           # Run acceptance tests (UC1-UC4)
- npm run test:coverage             # Generate coverage report
- npm run docs                      # Generate documentation

FAPI 2.0 Specific Commands:
- node oauth-demo.js                # OAuth 2.1/OIDC flow demonstration
- node client-registration-demo.js  # Dynamic client registration demo
- node security-audit-demo.js       # Security audit system demo
- curl localhost:3000/.well-known/openid-configuration  # OIDC discovery
- curl localhost:3000/.well-known/fapi-configuration     # FAPI metadata
